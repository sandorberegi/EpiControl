<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="EpiControl">
<title>Ebola example - using EpiEstim for estimation • EpiControl</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Ebola example - using EpiEstim for estimation">
<meta property="og:description" content="EpiControl">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">EpiControl</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/control_est_D.html">MPC with death data only</a>
    <a class="dropdown-item" href="../articles/epiestim_ebola.html">Ebola example - using EpiEstim for estimation</a>
    <a class="dropdown-item" href="../articles/multiple_NPIs.html">multiple_NPIs</a>
    <a class="dropdown-item" href="../articles/Report9_MPC.html">Simulating Epidemic Dynamics with Policy Interventions</a>
    <a class="dropdown-item" href="../articles/Report9_threshold_based.html">Report9_threshold_based</a>
    <a class="dropdown-item" href="../articles/vaccine_variants_MPC.html">Vaccination and new variant</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Ebola example - using EpiEstim for estimation</h1>
            
      
      
      <div class="d-none name"><code>epiestim_ebola.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sandorberegi.github.io/EpiControl/">EpiControl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.auckland.ac.nz/~yee/VGAM/" class="external-link">VGAM</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/psolymos/pbapply" class="external-link">pbapply</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://zoo.R-Forge.R-project.org/" class="external-link">zoo</a></span><span class="op">)</span>  <span class="co"># For rolling sum operations</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mrc-ide/EpiEstim" class="external-link">EpiEstim</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="data-preprocessing">Data preprocessing<a class="anchor" aria-label="anchor" href="#data-preprocessing"></a>
</h3>
<p>We will first load the dataset containing cases of West African
Ebola. Garske, T. et al. Heterogeneities in the case fatality ratio in
the West African Ebola outbreak 2013–2016. Philos. Trans. R. Soc. Lond.
B Biol. Sci. 372, 20160308 2017. <a href="https://royalsocietypublishing.org/doi/10.1098/rstb.2016.0308" class="external-link">link</a></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read data</span></span>
<span><span class="va">ebola_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"ebola_data/rstb20160308_si_001.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract and convert date column</span></span>
<span><span class="va">date_reported</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">ebola_data</span><span class="op">$</span><span class="va">DateReport</span><span class="op">)</span>  <span class="co"># Ensure it's in Date format</span></span>
<span><span class="va">date_inferred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">ebola_data</span><span class="op">$</span><span class="va">DateOnsetInferred</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a sequence of all dates from min to max</span></span>
<span><span class="va">all_dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>date_reported <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">date_reported</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                                            <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">date_reported</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                                            by <span class="op">=</span> <span class="st">"day"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Count occurrences of each reported date</span></span>
<span><span class="va">date_counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">date_reported</span>, useNA <span class="op">=</span> <span class="st">"no"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">date_counts_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">date_inferred</span>, useNA <span class="op">=</span> <span class="st">"no"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">date_counts</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"date_reported"</span>, <span class="st">"count"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">date_counts_i</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"date_reported"</span>, <span class="st">"count"</span><span class="op">)</span></span>
<span><span class="va">date_counts</span><span class="op">$</span><span class="va">date_reported</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">date_counts</span><span class="op">$</span><span class="va">date_reported</span><span class="op">)</span></span>
<span><span class="va">date_counts_i</span><span class="op">$</span><span class="va">date_reported</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">date_counts_i</span><span class="op">$</span><span class="va">date_reported</span><span class="op">)</span><span class="co"># Convert back to Date format</span></span>
<span></span>
<span><span class="co"># Merge full date range with counts, filling missing dates with 0</span></span>
<span><span class="va">date_counts_filled</span> <span class="op">&lt;-</span> <span class="va">all_dates</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">date_counts</span>, by <span class="op">=</span> <span class="st">"date_reported"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/replace_na.html" class="external-link">replace_na</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">date_counts_i_filled</span> <span class="op">&lt;-</span> <span class="va">all_dates</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">date_counts_i</span>, by <span class="op">=</span> <span class="st">"date_reported"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/replace_na.html" class="external-link">replace_na</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">date_counts_filled</span><span class="op">$</span><span class="va">count_i</span> <span class="op">&lt;-</span> <span class="va">date_counts_i_filled</span><span class="op">$</span><span class="va">count</span></span>
<span></span>
<span><span class="co"># Visualise daily epidemic cases curves (when reported and as occurence inferred)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">date_counts_filled</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date_reported</span>, y <span class="op">=</span> <span class="va">count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Line plot for cases over time</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date_reported</span>, y <span class="op">=</span> <span class="va">count_i</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Ebola Cases Over Time"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Number of Cases"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="epiestim_ebola_files/figure-html/load-data-1.png" width="700"></p>
<p>Let’s estimate R from this data using EpiEstim.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cases_v</span> <span class="op">&lt;-</span> <span class="va">date_counts_filled</span><span class="op">$</span><span class="va">count_i</span></span>
<span></span>
<span><span class="va">ndays</span> <span class="op">&lt;-</span> <span class="fl">833</span><span class="co">#epidemic length #simulation length</span></span>
<span></span>
<span><span class="co"># Assumed generation time distribution</span></span>
<span><span class="va">Ygen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">ndays</span>, <span class="fl">15.0</span><span class="op">/</span><span class="fl">2.1</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">2.1</span><span class="op">)</span></span>
<span><span class="va">Ygen</span> <span class="op">&lt;-</span> <span class="va">Ygen</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Ygen</span><span class="op">)</span></span>
<span><span class="va">Ygen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">Ygen</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/EpiEstim/man/estimate_R.html" class="external-link">estimate_R</a></span><span class="op">(</span>incid <span class="op">=</span> <span class="va">cases_v</span>,</span>
<span>                  method <span class="op">=</span> <span class="st">"non_parametric_si"</span>,</span>
<span>                  config <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/EpiEstim/man/make_config.html" class="external-link">make_config</a></span><span class="op">(</span>si_distr <span class="op">=</span> <span class="va">Ygen</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<p><img src="epiestim_ebola_files/figure-html/epiestim-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="simulation-setup">Simulation setup<a class="anchor" aria-label="anchor" href="#simulation-setup"></a>
</h3>
<p>We simulate a controlled epidemic starting on day 210 after the first
case. We will set the control target to 50 cases/day. We will model
susceptible depletion by infected individuals getting removed from the
susceptible group. We expect the control to balance cases around the
target until herd immunity is reached and then no further interventions
applied.</p>
<p>Initialise the cluster for parallel computing:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="va">cores</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/RngStream.html" class="external-link">clusterSetRNGStream</a></span><span class="op">(</span><span class="va">cl</span>, iseed <span class="op">=</span> <span class="fl">20250501</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="define-the-epidemic-ans-noise-parameters">Define the epidemic ans noise parameters<a class="anchor" aria-label="anchor" href="#define-the-epidemic-ans-noise-parameters"></a>
</h3>
<p>We will use pathogen = 2 corresponding to Ebola Virus Disease.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Epi_pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Pathogen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"COVID-19"</span>, <span class="st">"Ebola"</span><span class="op">)</span>,</span>
<span>  R0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.305201</span><span class="op">/</span><span class="fl">0.5</span>, <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>  gen_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6.5</span>, <span class="fl">15.0</span><span class="op">)</span>,</span>
<span>  gen_time_var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.1</span>, <span class="fl">2.1</span><span class="op">)</span>,</span>
<span>  CFR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.0132</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  mortality_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10.0</span>, <span class="fl">10.0</span><span class="op">)</span>,</span>
<span>  mortality_var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.1</span>, <span class="fl">1.1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">Noise_pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  repd_mean <span class="op">=</span> <span class="fl">10.5</span>,  <span class="co"># Reporting delay mean</span></span>
<span>  del_disp <span class="op">=</span> <span class="fl">5.0</span>,    <span class="co"># Reporting delay variance</span></span>
<span>  ur_mean <span class="op">=</span> <span class="fl">0.3</span>,     <span class="co"># Under-reporting mean</span></span>
<span>  ur_beta_a <span class="op">=</span> <span class="fl">50.0</span>   <span class="co"># Beta distribution alpha for under-reporting</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="action-space-for-policy-interventions">Action Space for Policy Interventions<a class="anchor" aria-label="anchor" href="#action-space-for-policy-interventions"></a>
</h3>
<p>Define non-pharmaceutical interventions: We have 3 actions,
introducing a lockdown, social distancing and no interventions.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Setting-up the control (using non-pharmaceutical interventions)</span></span>
<span><span class="va">Action_space</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span> <span class="op">(</span></span>
<span>  NPI <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"No restrictions"</span>, <span class="st">"Social distancing"</span>, <span class="st">"Lockdown"</span><span class="op">)</span>,</span>
<span>  R_coeff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">0.7</span>, <span class="fl">0.4</span><span class="op">)</span>, <span class="co">#R0_act = R0 * ctrl_states</span></span>
<span>  R_beta_a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.0</span>, <span class="fl">5.0</span>, <span class="fl">5.0</span><span class="op">)</span>, <span class="co">#R0_act uncertainty</span></span>
<span>  cost_of_NPI <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.0</span>, <span class="fl">0.01</span>, <span class="fl">0.15</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="simulation-parameters">Simulation parameters<a class="anchor" aria-label="anchor" href="#simulation-parameters"></a>
</h3>
<p>We set the simulation parameters, targets, R estimation window etc.
below. We do not account for vaccination or new variants, therefore we
set v_max_rate = 0 and delta_multiplier = 1.0.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1e6</span> <span class="co"># population size</span></span>
<span><span class="va">I0</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="co"># initial infections</span></span>
<span><span class="va">real_days</span> <span class="op">&lt;-</span> <span class="fl">210L</span> <span class="co">#we start the simulation from data here</span></span>
<span></span>
<span><span class="co">#Simulation parameters</span></span>
<span><span class="va">n_ens</span> <span class="op">&lt;-</span> <span class="fl">20L</span> <span class="co">#MC assembly size for 4</span></span>
<span><span class="va">sim_ens</span> <span class="op">&lt;-</span> <span class="fl">20L</span> <span class="co">#assembly size for full simulation</span></span>
<span></span>
<span><span class="va">C_target</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">D_target</span> <span class="op">&lt;-</span> <span class="fl">25</span></span>
<span><span class="va">r_trans_len</span> <span class="op">&lt;-</span> <span class="fl">7</span></span>
<span></span>
<span><span class="va">sim_settings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  ndays <span class="op">=</span> <span class="va">ndays</span>, <span class="co">#simulation length</span></span>
<span>  start_day <span class="op">=</span> <span class="va">real_days</span>,</span>
<span>  N <span class="op">=</span> <span class="va">N</span>, <span class="co"># population size</span></span>
<span>  I0 <span class="op">=</span> <span class="va">I0</span>, <span class="co"># initial infections</span></span>
<span>  C_target <span class="op">=</span> <span class="va">C_target</span>, <span class="co">#target cases</span></span>
<span>  C_target_pen <span class="op">=</span> <span class="va">C_target</span><span class="op">*</span><span class="fl">1.5</span>, <span class="co">#overshoot penalty threshold</span></span>
<span>  R_target <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span>  D_target <span class="op">=</span> <span class="va">D_target</span>, <span class="co">#one way to get peaks at 400 is to increase this to 15</span></span>
<span>  D_target_pen <span class="op">=</span> <span class="fl">50</span>, <span class="co">#max death</span></span>
<span>  <span class="co">#alpha = 1.3/C_target, #~proportional gain (regulates error in cases) covid</span></span>
<span>  alpha <span class="op">=</span> <span class="fl">3.25</span><span class="op">/</span><span class="va">C_target</span>, <span class="co">#~proportional gain (regulates error in cases) ebola</span></span>
<span>  alpha_d <span class="op">=</span> <span class="fl">0</span><span class="op">*</span><span class="fl">1.3</span><span class="op">/</span><span class="va">D_target</span>,</span>
<span>  ovp <span class="op">=</span> <span class="fl">5.0</span>, <span class="co">#overshoot penalty</span></span>
<span>  dovp <span class="op">=</span> <span class="fl">0</span><span class="op">*</span><span class="fl">10.0</span>, <span class="co">#death overshoot penalty</span></span>
<span>  gamma <span class="op">=</span> <span class="fl">0.95</span>, <span class="co">#discounting factor</span></span>
<span>  n_ens <span class="op">=</span> <span class="va">n_ens</span>, <span class="co">#MC assembly size for 4</span></span>
<span>  sim_ens <span class="op">=</span> <span class="va">sim_ens</span>, <span class="co">#assembly size for full simulation</span></span>
<span>  rf <span class="op">=</span> <span class="fl">14L</span>, <span class="co">#days 14</span></span>
<span>  R_est_wind <span class="op">=</span> <span class="fl">5L</span>, <span class="co">#rf-2 #window for R estimation</span></span>
<span>  pred_days <span class="op">=</span> <span class="fl">21L</span>,</span>
<span>  r_trans_steep <span class="op">=</span> <span class="fl">1.5</span>,  <span class="co"># Growth rate</span></span>
<span>  r_trans_len <span class="op">=</span> <span class="va">r_trans_len</span>,  <span class="co"># Number of days for the transition</span></span>
<span>  t0 <span class="op">=</span> <span class="va">r_trans_len</span>  <span class="op">/</span> <span class="fl">2</span>, <span class="co"># Midpoint of the transition</span></span>
<span>  pathogen <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  susceptibles <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  delay <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  ur <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  r_dir <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  LD_on <span class="op">=</span> <span class="fl">14</span>, <span class="co">#on threshold</span></span>
<span>  LD_off <span class="op">=</span> <span class="fl">7</span>, <span class="co">#off threshold</span></span>
<span>  v_max_rate <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  vac_scale <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  vac_start <span class="op">=</span> <span class="fl">370</span>,</span>
<span>  delta_scale <span class="op">=</span> <span class="fl">40</span>,</span>
<span>  delta_start <span class="op">=</span> <span class="fl">550</span>,</span>
<span>  delta_multiplier <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span>  v_protection_delta <span class="op">=</span> <span class="op">(</span><span class="fl">58</span><span class="op">+</span><span class="fl">85</span><span class="op">)</span><span class="op">/</span><span class="fl">200</span>,</span>
<span>  v_protection_alpha <span class="op">=</span> <span class="fl">0.83</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Construct our simulation dataframe:</span></span>
<span><span class="va">column_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"days"</span>, <span class="st">"sim_id"</span>, <span class="st">"I"</span>, <span class="st">"Lambda"</span>, <span class="st">"C"</span>, <span class="st">"Lambda_C"</span>, <span class="st">"S"</span>, <span class="st">"Re"</span>, <span class="st">"Rew"</span>, <span class="st">"Rest"</span>, <span class="st">"R0est"</span>, <span class="st">"policy"</span>, <span class="st">"R_coeff"</span>, <span class="st">"Real_C"</span>, <span class="st">"vaccination_rate"</span>, <span class="st">"delta_prevalence"</span>,<span class="st">"immunity"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create an empty data frame with specified column names</span></span>
<span><span class="va">empty_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">column_names</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">empty_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">column_names</span></span>
<span></span>
<span><span class="co"># Create a zero matrix with 10 rows</span></span>
<span><span class="va">zero_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="va">ndays</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">column_names</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">zero_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">column_names</span></span>
<span></span>
<span><span class="co"># Combine empty data frame and zero matrix using rbind</span></span>
<span><span class="va">episim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">empty_df</span>, <span class="va">zero_matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#initialisation</span></span>
<span></span>
<span><span class="va">episim_data</span><span class="op">[</span><span class="st">'policy'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">ndays</span><span class="op">)</span></span>
<span><span class="va">episim_data</span><span class="op">[</span><span class="st">'sim_id'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">ndays</span><span class="op">)</span></span>
<span><span class="va">episim_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">real_days</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="va">I0</span>, <span class="va">I0</span>, <span class="va">Noise_pars</span><span class="op">[</span><span class="st">'ur_mean'</span><span class="op">]</span><span class="op">*</span><span class="va">I0</span>, <span class="va">Noise_pars</span><span class="op">[</span><span class="st">'ur_mean'</span><span class="op">]</span><span class="op">*</span><span class="va">I0</span>, <span class="va">N</span><span class="op">-</span><span class="va">I0</span>, <span class="va">Epi_pars</span><span class="op">[</span><span class="fl">1</span>,<span class="st">'R0'</span><span class="op">]</span><span class="op">*</span><span class="fl">0.5</span>, <span class="va">Epi_pars</span><span class="op">[</span><span class="fl">1</span>,<span class="st">'R0'</span><span class="op">]</span><span class="op">*</span><span class="fl">0.5</span>, <span class="va">Epi_pars</span><span class="op">[</span><span class="fl">1</span>,<span class="st">'R0'</span><span class="op">]</span><span class="op">*</span><span class="fl">0.5</span>, <span class="va">Epi_pars</span><span class="op">[</span><span class="fl">1</span>,<span class="st">'R0'</span><span class="op">]</span>, <span class="fl">2</span>, <span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">episim_data</span><span class="op">[</span><span class="st">'days'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">ndays</span></span>
<span><span class="va">episim_data</span><span class="op">[</span><span class="st">'date'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">all_dates</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">ndays</span>, <span class="st">'date_reported'</span><span class="op">]</span></span>
<span></span>
<span><span class="va">episim_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">real_days</span>,<span class="st">"C"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">date_counts_filled</span><span class="op">$</span><span class="va">count_i</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">real_days</span><span class="op">]</span></span>
<span><span class="va">episim_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">real_days</span>,<span class="st">"I"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">date_counts_filled</span><span class="op">$</span><span class="va">count_i</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">real_days</span><span class="op">]</span><span class="op">/</span><span class="fl">0.3</span></span>
<span><span class="va">episim_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">episim_data</span><span class="op">)</span>,<span class="st">"Real_C"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">date_counts_filled</span><span class="op">$</span><span class="va">count_i</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">episim_data</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># get infectiousness and estimated R-s</span></span>
<span></span>
<span><span class="va">gen_time</span> <span class="op">&lt;-</span> <span class="fl">15.0</span></span>
<span><span class="va">gen_time_var</span> <span class="op">&lt;-</span> <span class="fl">2.1</span></span>
<span></span>
<span><span class="va">R_est_wind</span> <span class="op">&lt;-</span> <span class="fl">5</span>  <span class="co"># Define your window size</span></span>
<span></span>
<span><span class="va">Ygen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ebola_data</span><span class="op">)</span>, <span class="va">gen_time</span><span class="op">/</span><span class="va">gen_time_var</span>, <span class="fl">1</span><span class="op">/</span><span class="va">gen_time_var</span><span class="op">)</span></span>
<span><span class="va">Ygen</span> <span class="op">&lt;-</span> <span class="va">Ygen</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Ygen</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Estimate R</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">ii</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">real_days</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">ii</span><span class="op">-</span><span class="fl">1</span> <span class="op">&lt;</span> <span class="va">R_est_wind</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">episim_data</span><span class="op">[</span><span class="va">ii</span>, <span class="st">'Rest'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">episim_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">ii</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="st">'C'</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">episim_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">ii</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="st">'Lambda_C'</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">R_coeff_tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Ygen</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">ii</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span> <span class="op">*</span> <span class="va">episim_data</span><span class="op">[</span><span class="op">(</span><span class="va">ii</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="fl">1</span>, <span class="st">'R_coeff'</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Ygen</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">ii</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">episim_data</span><span class="op">[</span><span class="op">(</span><span class="va">ii</span><span class="op">-</span><span class="va">R_est_wind</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">ii</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="st">'Lambda_C'</span><span class="op">]</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">episim_data</span><span class="op">[</span><span class="va">ii</span>, <span class="st">'Rest'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>      <span class="va">R_coeff_tmp</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">episim_data</span><span class="op">[</span><span class="va">ii</span>, <span class="st">'Rest'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">episim_data</span><span class="op">[</span><span class="op">(</span><span class="va">ii</span><span class="op">-</span><span class="va">R_est_wind</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">ii</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="st">'C'</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">episim_data</span><span class="op">[</span><span class="op">(</span><span class="va">ii</span><span class="op">-</span><span class="va">R_est_wind</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">ii</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="st">'Lambda_C'</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="va">R_coeff_tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Ygen</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">ii</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span> <span class="op">*</span> <span class="va">episim_data</span><span class="op">[</span><span class="op">(</span><span class="va">ii</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="fl">1</span>, <span class="st">'R_coeff'</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Ygen</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">ii</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">episim_data</span><span class="op">[</span><span class="va">ii</span>, <span class="st">'R0est'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">episim_data</span><span class="op">[</span><span class="va">ii</span>, <span class="st">'Rest'</span><span class="op">]</span> <span class="op">/</span> <span class="va">R_coeff_tmp</span></span>
<span>  <span class="va">episim_data</span><span class="op">[</span><span class="va">ii</span>, <span class="st">'Lambda_C'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">episim_data</span><span class="op">[</span><span class="op">(</span><span class="va">ii</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="fl">1</span>,<span class="st">'C'</span><span class="op">]</span><span class="op">*</span><span class="va">Ygen</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">ii</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">episim_data</span><span class="op">[</span><span class="va">ii</span>, <span class="st">'Lambda'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">episim_data</span><span class="op">[</span><span class="op">(</span><span class="va">ii</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="fl">1</span>,<span class="st">'I'</span><span class="op">]</span><span class="op">*</span><span class="va">Ygen</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">ii</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">Epi_pars</span><span class="op">[</span><span class="fl">1</span>,<span class="st">"R0"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">episim_data</span><span class="op">[</span><span class="va">real_days</span>, <span class="st">'R0est'</span><span class="op">]</span></span>
<span></span>
<span><span class="va">episim_data_ens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">sim_ens</span>, <span class="va">episim_data</span>, simplify <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">ii</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">sim_ens</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">episim_data_ens</span><span class="op">[[</span><span class="va">ii</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">sim_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">ii</span>, <span class="va">ndays</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="running-the-simulation">Running the simulation<a class="anchor" aria-label="anchor" href="#running-the-simulation"></a>
</h3>
<p>Passing the simulation setup to epicontrol and running the
simulation.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">episettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  sim_function <span class="op">=</span> <span class="va">Epi_MPC_run_V</span>,</span>
<span>  reward_function <span class="op">=</span> <span class="va">reward_fun</span>,</span>
<span>  R_estimator <span class="op">=</span> <span class="va">R_estim</span>,</span>
<span>  noise_par <span class="op">=</span> <span class="va">Noise_pars</span>,</span>
<span>  epi_par <span class="op">=</span> <span class="va">Epi_pars</span>,</span>
<span>  actions <span class="op">=</span> <span class="va">Action_space</span>,</span>
<span>  sim_settings <span class="op">=</span> <span class="va">sim_settings</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">episim_data_ens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">sim_ens</span>, <span class="va">episim_data</span>, simplify <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">ii</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">sim_ens</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">episim_data_ens</span><span class="op">[[</span><span class="va">ii</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">sim_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">ii</span>, <span class="va">ndays</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">episettings</span><span class="op">$</span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="va">cl</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epicontrol.html">epicontrol</a></span><span class="op">(</span><span class="va">episim_data_ens</span>, <span class="va">episettings</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt;   |                                                          |                                                  |   0%</span></span>
<span></span>
<span><span class="va">episim_data_ens</span> <span class="op">&lt;-</span> <span class="va">results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## For non-parallel runs:</span></span>
<span></span>
<span><span class="co">#for (jj in 1:sim_ens) {</span></span>
<span><span class="co">#  episim_data_ens[[jj]] &lt;- Epi_MPC_run_wd(episim_data_ens[[jj]], Epi_pars, Noise_pars, Action_space, pred_days = pred_days, n_ens = n_ens, ndays = nrow(episim_data), R_est_wind = R_est_wind, pathogen = 1, susceptibles = 0, delay = 0, ur = 0, r_dir = 2, N = N)</span></span>
<span><span class="co">#  setTxtProgressBar(pb,jj)</span></span>
<span><span class="co">#}</span></span>
<span><span class="co">#close(pb)</span></span>
<span></span>
<span><span class="co"># Combine Simulation Results</span></span>
<span><span class="va">combined_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">episim_data_ens</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plotting-results">Plotting results<a class="anchor" aria-label="anchor" href="#plotting-results"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">combined_data</span> <span class="op">&lt;-</span> <span class="va">combined_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sim_id</span>, <span class="va">policy</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">days</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">days</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">combined_data</span> <span class="op">&lt;-</span> <span class="va">combined_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">sim_id</span>, <span class="va">days</span>, <span class="va">policy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">policy_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"Historical data"</span>, <span class="st">"2"</span> <span class="op">=</span> <span class="st">"Social distancing"</span>, <span class="st">"3"</span> <span class="op">=</span> <span class="st">"Lockdown"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">combined_data</span><span class="op">$</span><span class="va">policy</span><span class="op">[</span><span class="va">combined_data</span><span class="op">$</span><span class="va">days</span> <span class="op">&lt;</span> <span class="va">real_days</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">combined_data</span><span class="op">$</span><span class="va">date</span> <span class="op">&lt;-</span> <span class="va">date_counts_i_filled</span><span class="op">[</span><span class="fl">1</span>, <span class="st">'date_reported'</span><span class="op">]</span>  <span class="op">+</span> <span class="op">(</span><span class="va">combined_data</span><span class="op">$</span><span class="va">days</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># Assuming combined_data has a 'date' column</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">combined_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sim_id</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">combined_data</span>, <span class="va">sim_id</span> <span class="op">!=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">C</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">sim_id</span><span class="op">)</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">C</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">policy</span>, labels <span class="op">=</span> <span class="va">policy_labels</span><span class="op">)</span>, group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">Real_C</span>, color <span class="op">=</span> <span class="st">"blue"</span>, group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">1.0</span>, size <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">C_target</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"blue"</span>, size <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">date_counts_i_filled</span><span class="op">[</span><span class="fl">1</span>, <span class="st">'date_reported'</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="va">real_days</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>             linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Reported cases"</span>, color <span class="op">=</span> <span class="st">"Policy"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"No intervention"</span> <span class="op">=</span> <span class="st">"chartreuse3"</span>,</span>
<span>                                <span class="st">"Social distancing"</span> <span class="op">=</span> <span class="st">"darkorchid1"</span>,</span>
<span>                                <span class="st">"Lockdown"</span> <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>                                <span class="st">"Historical data"</span> <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Policy"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="epiestim_ebola_files/figure-html/plot-results-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">combined_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sim_id</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">Re</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">policy</span>, labels <span class="op">=</span> <span class="va">policy_labels</span><span class="op">)</span>, group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"No intervention"</span> <span class="op">=</span> <span class="st">"chartreuse3"</span>,</span>
<span>                                <span class="st">"Social distancing"</span> <span class="op">=</span> <span class="st">"darkorchid1"</span>,</span>
<span>                                <span class="st">"Lockdown"</span> <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>                                <span class="st">"Historical data"</span> <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Re"</span>, color <span class="op">=</span> <span class="st">"Policy"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Policy"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">date_counts_i_filled</span><span class="op">[</span><span class="fl">1</span>, <span class="st">'date_reported'</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="va">real_days</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>             linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="epiestim_ebola_files/figure-html/plot-R-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sandor Beregi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
